<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CBDB Agentic RAG Chat</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🦙</text></svg>">
</head>
<body class="min-h-screen bg-gradient-primary flex flex-col font-sans antialiased">
  
  <!-- Top Navigation Bar -->
  <nav class="nav-glass sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        
        <!-- Logo and Brand -->
        <div class="flex items-center space-x-3">
          <div class="text-2xl animate-pulse">🦙</div>
          <div>
            <h1 class="text-white text-lg font-bold tracking-tight" data-i18n="app.title">CBDB Agentic RAG Chat</h1>
            <p class="text-white/70 text-xs" data-i18n="app.description">Intelligent document analysis and conversational AI system</p>
          </div>
        </div>
        
        <!-- Navigation Menu -->
        <div class="hidden md:flex items-center space-x-1">
          <!-- Language Toggle -->
          <div class="relative">
            <button id="language-toggle" class="btn-ghost" onclick="toggleLanguageMenu()">
              <span id="current-flag">🇺🇸</span>
              <span class="ml-1" data-i18n="nav.language">Language</span>
              <svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            
            <!-- Language Dropdown -->
            <div id="language-menu" class="hidden absolute right-0 mt-2 w-32 bg-white rounded-lg shadow-xl border border-gray-200">
              <button onclick="switchLanguage('en')" class="w-full px-3 py-2 text-left text-gray-700 hover:bg-gray-50 rounded-t-lg transition-colors flex items-center space-x-2">
                <span>🇺🇸</span>
                <span>English</span>
              </button>
              <button onclick="switchLanguage('zh')" class="w-full px-3 py-2 text-left text-gray-700 hover:bg-gray-50 rounded-b-lg transition-colors flex items-center space-x-2">
                <span>🇨🇳</span>
                <span>中文</span>
              </button>
            </div>
          </div>
          
          <button class="btn-ghost" onclick="showInfo()">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span data-i18n="nav.about">About</span>
          </button>
          <button class="btn-ghost" onclick="toggleFullscreen()">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
            </svg>
            <span data-i18n="nav.fullscreen">Fullscreen</span>
          </button>
          <button class="btn-ghost" onclick="refreshApp()">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
            </svg>
            <span data-i18n="nav.refresh">Refresh</span>
          </button>
        </div>
        
        <!-- Direct Access Button -->
        <div class="flex items-center space-x-3">
          <a href="#" 
             target="_blank" 
             class="btn-secondary group streamlit-link">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
            </svg>
            <span class="hidden sm:inline" data-i18n="buttons.visitDirect">Issues? Visit Streamlit direct</span>
            <span class="sm:hidden">Direct</span>
            <span class="ml-1 text-xs opacity-75 group-hover:opacity-100">↗</span>
          </a>
          
          <!-- Mobile Menu Button -->
          <button class="md:hidden btn-ghost" onclick="toggleMobileMenu()">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
      </div>
      
      <!-- Mobile Menu -->
      <div id="mobile-menu" class="hidden md:hidden pb-4">
        <div class="flex flex-col space-y-2">
          <!-- Mobile Language Toggle -->
          <div class="flex space-x-2 mb-2">
            <button onclick="switchLanguage('en')" class="btn-ghost justify-start flex-1">
              <span class="mr-2">🇺🇸</span>
              English
            </button>
            <button onclick="switchLanguage('zh')" class="btn-ghost justify-start flex-1">
              <span class="mr-2">🇨🇳</span>
              中文
            </button>
          </div>
          
          <button class="btn-ghost justify-start" onclick="showInfo()">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span data-i18n="nav.about">About</span>
          </button>
          <button class="btn-ghost justify-start" onclick="toggleFullscreen()">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
            </svg>
            <span data-i18n="nav.fullscreen">Fullscreen</span>
          </button>
          <button class="btn-ghost justify-start" onclick="refreshApp()">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
            </svg>
            <span data-i18n="nav.refreshApp">Refresh App</span>
          </button>
        </div>
      </div>
    </div>
  </nav>
  
  <!-- Status Bar -->
  <div id="status-bar" class="bg-green-500/20 border-b border-green-500/30 px-4 py-2 hidden">
    <div class="max-w-7xl mx-auto flex items-center justify-between">
      <div class="flex items-center space-x-2">
        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
        <span class="text-green-100 text-sm font-medium" data-i18n="status.connected">Connected to RAG System</span>
      </div>
      <button onclick="hideStatusBar()" class="text-green-100/70 hover:text-green-100">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
  </div>
  
  <!-- Main Container -->
  <div class="flex-1 p-4 lg:p-6">
    <div class="max-w-7xl mx-auto h-full">
      <div class="card-solid h-full overflow-hidden relative min-h-[600px] lg:min-h-[700px] flex flex-col">
        
        <!-- App Header -->
        <div class="bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 bg-gradient-primary rounded-lg flex items-center justify-center text-white font-bold text-sm shadow-lg">
                RAG
              </div>
              <div>
                <h2 class="text-gray-800 font-semibold text-lg" data-i18n="app.title">CBDB Agentic RAG Chat</h2>
                <p class="text-gray-500 text-sm" data-i18n="app.subtitle">Advanced AI-powered Retrieval Augmented Generation</p>
              </div>
            </div>
            
            <!-- Connection Status -->
            <div class="flex items-center space-x-2">
              <div id="connection-status" class="flex items-center space-x-2">
                <div class="w-2 h-2 bg-yellow-400 rounded-full animate-pulse"></div>
                <span class="text-gray-600 text-sm" data-i18n="status.connecting">Connecting...</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Loading State -->
        <div id="loading" class="absolute inset-0 flex flex-col items-center justify-center z-10 bg-white">
          <div class="spinner mb-6"></div>
          <div class="text-gray-600 text-xl font-medium mb-2" data-i18n="status.loading">Loading RAG Chat App</div>
          <div class="text-gray-500 text-sm" data-i18n="status.initializing">Initializing AI system...</div>
          <div class="mt-6 flex space-x-2">
            <div class="w-2 h-2 bg-primary-400 rounded-full animate-bounce"></div>
            <div class="w-2 h-2 bg-primary-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
            <div class="w-2 h-2 bg-primary-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
          </div>
        </div>
        
        <!-- Iframe Container -->
        <div id="iframe-wrapper" class="flex-1 relative bg-gray-50">
          <iframe 
            id="streamlit-frame"
            src=""
            title="CBDB Agentic RAG Chat Application"
            allow="camera; microphone; clipboard-read; clipboard-write"
            sandbox="allow-same-origin allow-scripts allow-forms allow-downloads allow-modals allow-popups allow-presentation"
            loading="lazy"
            class="w-full h-full border-0 absolute inset-0">
          </iframe>
        </div>
        
        <!-- Enhanced Fallback Content -->
        <div id="fallback-content" class="hidden flex-col items-center justify-center h-full p-8 text-center bg-gradient-to-br from-gray-50 to-gray-100">
          
          <!-- Hero Section -->
          <div class="animate-float mb-12">
            <div class="text-8xl mb-6 filter drop-shadow-lg">🦙</div>
            <h2 class="text-4xl font-bold text-gradient mb-4" data-i18n="fallback.title">CBDB Agentic RAG Chat</h2>
            <p class="text-gray-600 text-xl leading-relaxed max-w-lg" data-i18n="fallback.description">
              Experience the full power of our Retrieval Augmented Generation system in its native environment. Due to browser security policies, we'll redirect you to the official app for the best user experience.
            </p>
          </div>
          
          <!-- Features Grid -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mb-12">
            <div class="card-glass p-6 text-center hover:scale-105 transition-transform duration-300">
              <div class="w-12 h-12 bg-gradient-primary rounded-xl flex items-center justify-center mx-auto mb-4">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                </svg>
              </div>
              <h3 class="font-bold text-gray-800 text-lg mb-2" data-i18n="features.conversations.title">Smart Conversations</h3>
              <p class="text-gray-600 text-sm" data-i18n="features.conversations.description">Natural language processing with document context</p>
            </div>
            
            <div class="card-glass p-6 text-center hover:scale-105 transition-transform duration-300">
              <div class="w-12 h-12 bg-gradient-secondary rounded-xl flex items-center justify-center mx-auto mb-4">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                </svg>
              </div>
              <h3 class="font-bold text-gray-800 text-lg mb-2" data-i18n="features.retrieval.title">Document Retrieval</h3>
              <p class="text-gray-600 text-sm" data-i18n="features.retrieval.description">Advanced search and knowledge extraction from documents</p>
            </div>
            
            <div class="card-glass p-6 text-center hover:scale-105 transition-transform duration-300">
              <div class="w-12 h-12 bg-gradient-to-br from-primary-600 to-primary-800 rounded-xl flex items-center justify-center mx-auto mb-4">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                </svg>
              </div>
              <h3 class="font-bold text-gray-800 text-lg mb-2" data-i18n="features.generation.title">AI Generation</h3>
              <p class="text-gray-600 text-sm" data-i18n="features.generation.description">Context-aware content generation and analysis</p>
            </div>
          </div>
          
          <!-- Call to Action -->
          <div class="space-y-6">
            <a href="#" target="_blank" class="btn-primary group text-center streamlit-link">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
              <span data-i18n="buttons.launchApp">Launch RAG Chat</span>
              <svg class="w-4 h-4 ml-3 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
              </svg>
            </a>
            
            <div class="text-gray-500 text-sm space-y-2">
              <p>🚀 <strong data-i18n="fallback.benefits.experience">Best Experience: Opens in a new tab with full functionality</strong></p>
              <p>🔒 <strong data-i18n="fallback.benefits.secure">Secure: Direct connection to Streamlit Cloud</strong></p>
              <p>📱 <strong data-i18n="fallback.benefits.mobile">Mobile Ready: Optimized for all devices</strong></p>
            </div>
          </div>
          
          <!-- Keyboard Shortcuts -->
          <div class="mt-12 p-4 bg-white/50 rounded-lg border border-white/60">
            <h4 class="font-semibold text-gray-700 mb-3 text-sm" data-i18n="shortcuts.title">⌨️ Keyboard Shortcuts</h4>
            <div class="grid grid-cols-2 gap-2 text-xs text-gray-600">
              <div class="flex items-center space-x-2">
                <kbd class="px-2 py-1 bg-white rounded border text-gray-700 font-mono text-xs">L</kbd>
                <span data-i18n="shortcuts.launch">Launch app</span>
              </div>
              <div class="flex items-center space-x-2">
                <kbd class="px-2 py-1 bg-white rounded border text-gray-700 font-mono text-xs">R</kbd>
                <span data-i18n="shortcuts.refresh">Refresh</span>
              </div>
              <div class="flex items-center space-x-2">
                <kbd class="px-2 py-1 bg-white rounded border text-gray-700 font-mono text-xs">F11</kbd>
                <span data-i18n="shortcuts.fullscreen">Fullscreen</span>
              </div>
              <div class="flex items-center space-x-2">
                <kbd class="px-2 py-1 bg-white rounded border text-gray-700 font-mono text-xs">I</kbd>
                <span data-i18n="shortcuts.info">Info</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Info Modal -->
  <div id="info-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
    <div class="card-solid max-w-md w-full p-6 relative">
      <button onclick="hideInfo()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
      
      <div class="text-center">
        <div class="text-4xl mb-4">🦙</div>
        <h3 class="text-xl font-bold text-gray-800 mb-2" data-i18n="modal.aboutTitle">About CBDB Agentic RAG Chat</h3>
        <p class="text-gray-600 text-sm leading-relaxed mb-4" data-i18n="modal.aboutDescription">
          This web application provides access to our advanced Retrieval Augmented Generation (RAG) system hosted on Streamlit Cloud. Built with Vite and Tailwind CSS for optimal performance and user experience.
        </p>
        
        <div class="text-left space-y-2 text-sm text-gray-600 mb-6">
          <div class="flex items-center space-x-2">
            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
            <span data-i18n="modal.features.streamlit">Powered by Streamlit Cloud</span>
          </div>
          <div class="flex items-center space-x-2">
            <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
            <span data-i18n="modal.features.tech">Built with Vite & Tailwind CSS</span>
          </div>
          <div class="flex items-center space-x-2">
            <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
            <span data-i18n="modal.features.deployment">Deployed on GitHub Pages</span>
          </div>
        </div>
        
        <button onclick="hideInfo()" class="w-full btn-primary">
          <span data-i18n="buttons.gotIt">Got it!</span>
        </button>
      </div>
    </div>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>